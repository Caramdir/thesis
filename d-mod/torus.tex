\chapter{Torus quotients}
\label{ch:d-mod:torus}

In this chapter we will apply the tools from the previous chapter to torus quotient stacks.
Specifically, we will prove the following theorem.

\begin{Thm}
    \label{thm:d-mod:torus:is-good}%
    Let $G$ be a torus acting locally linearly on a scheme $X$ of finite type over $k$.
    Then the stack $\stack X = X/G$ is good.
\end{Thm}

Together with Theorem~\ref{thm:d-mod:good-is-good} this implies our main result, Theorem~\ref{thm:d-mod:main}.

\begin{Rem}
    We only use the assumption that the action is locally linear to prove Lemma~\ref{lem:d-mod:finitely_many_stabilizers}, i.e.~that $\Stab\stack X$ is locally finite.
    Thus it would suffice to assume that $X$ can be covered by open subschemes for which Lemme~\ref{lem:d-mod:finitely_many_stabilizers} holds.
\end{Rem}

\begin{Rem}
    Theorem~\ref{thm:d-mod:torus:is-good} actually holds for $G$ the product of a torus and a finite Abelian group.
    The argument is exactly the same.
\end{Rem}

By Lemma~\ref{lem:d-mod:strategy:cover}, it suffices to prove Theorem~\ref{thm:d-mod:torus:is-good} for stacks $X/G$ with $X$ affine.
We fix an isomorphism $G \cong \Gm^n$ and compactify $G$ to $\bigl(\ps1\bigr)^n$.
The variety $\bigl(\ps1\bigr)^n$ can be covered by $G$-equivariant open subvarieties of the form $\as n$.
Thus by Lemma~\ref{lem:d-mod:strategy:cover-by-relative-compactifications}, it suffices to check \goodness\ for the relative compactification $\Gm^n \subseteq \as n$.
To simplify notation, we drop the subscript $\as n$ from the notation and set $\bar{\stack X} = \bar{\stack X}_{\as n}$ and similarly for the various maps.

We fix a quotient stack $\stack Y = Y/G$ and a morphism $h\colon \stack Y → \stack X$, induced by a $G$-equivariant morphism $\schemeh\colon Y → X$.
According to Lemma~\ref{lem:d-mod:strategy:scheme-cover}, rather than working with stack directly, we can base change to schemes.
We will use the notation of Lemma~\ref{lem:d-mod:strategy:scheme-cover}, but for ease of notation we will drop the subscript $\stack Y$ from the maps.
Thus we are concerned with the diagram
\[
    \begin{tikzcd}
        \schemelscY \stack X \arrow[r, hook, "\schemei"] &
        \schemeclsY \stack X \arrow[r, "\bar\schemeq"] &
        \bar Γ &
        Γ \arrow[l, hook', "\schemej"'],
    \end{tikzcd}
\]
where we have to show that $\schemei^* \bar\schemeq^! \schemej_!$ vanishes on $\catDModHolMon{Γ}{G×G}$.

The general idea is to introduce a $\Gm$-action that contracts $\schemelscY \stack X$ onto $\schemeclsY \stack X$.
In order to do so, we will cut the scheme
\[
    \schemeclsY \stack X =
    \biggl\{
        \bigl(g₁,\, y,\, g₂\bigr) ∈ G × Y × \bar G : \bigl(g₂,\, \schemeh(y),\, g₁\schemeh(y)\bigr) ∈ \bar Γ
    \biggr\}
\]
into pieces according to the subgroups of $G$ that stabilize $\schemeh(y)$.
For this let $\Stab\stack X$ be the set of all closed subgroups of $G$ that are stabilizers of points of $X$, i.e.
\[
    \Stab\stack X = \{ G_x : x ∈ X \}.
\]

\begin{Lem}
    \label{lem:d-mod:finitely_many_stabilizers}%
    The set $\Stab\stack X$ is finite.
\end{Lem}

\begin{proof}
    Since $X$ is affine, it can be embedded $G$-equivariantly into some $\as m$ with a linear $T$-action.
    For $\as m/T$ the statement is easy to see.
\end{proof}

Let $S$ be closed subgroup of $G$ and let $X^S$ be the $S$-fixed points of $X$.
Since $G$ is Abelian (and hence $S$ a normal subgroup), $X^S$ is a $G$-stable closed subscheme of $X$.
Hence $X^S/G$ is a closed substack of $\stack X$.
Let $\bar S$ be the closure of $S$ in $\bar G = \as n$ and consider the space
\[
    \schemecls[S]_{\stack Y} \stack X =
    \biggl\{
        \bigl(g₁,\, y,\, g₂\bigr) ∈ G × Y × \bar G : \schemeh(y) ∈ X^S,\, \bigl(g₂,\, \schemeh(y),\, g₁\schemeh(y)\bigr) ∈ \bar Γ \text{ and } g₂ ∈ g₁\bar S
    \biggr\}
    ⊆ 
    \schemecls_{\stack Y} \stack X.
\]

\begin{Lem}
    \label{lem:d-mod:stabilizers_cover}%
    The subspaces $\schemecls[S]_{\stack Y} \stack X$ for $S ∈ \Stab\stack X$ cover $\schemecls_{\stack Y}\stack X$.
\end{Lem}

\begin{proof}
    Let $\schemelsY \stack X$ be the smooth cover of $\ls_{\stack Y}\stack X$.
    Consider the spaces
    \[
        \schemelsY[S] \stack X = 
        \biggl\{
            \bigl(g₁,\, y,\, g₂\bigr) ∈ G × Y × G : \schemeh(y) ∈ X^S,\, \bigl(g₂,\, \schemeh(y),\, g₁\schemeh(y)\bigr) ∈ Γ \text{ and } g₂ ∈ g₁S
        \biggr\}
        \subseteq \schemelsY \stack X.
    \]
    The closure of $\schemelsY[S] \stack X$ in $\schemeclsY \stack X$ is exactly $\schemeclsY[S] \stack X$.
    It is easy to see that the subspaces $\schemelsY[S] \stack X$ for $S ∈ \Stab \stack X$ cover $\schemelsY[S] \stack X$.
    Now the statement follows from the fact that the closure of a finite union is the union of the individual closures.
\end{proof}

It will be useful to have a slight generalization of the schemes $\schemeclsY[S]$.
Let $S₁ \subseteq S₂$ be two subgroups of $G$ contained in $\Stab\stack X$.
We set
\[
    \schemeclsY[S₁,S₂] \stack X =
    \biggl\{
        \bigl(g₁,\, y,\, g₂\bigr) ∈ G × Y × \bar G : \schemeh(y) ∈ X^{S₂},\, \bigl(g₂,\, \schemeh(y),\, g₁\schemeh(y)\bigr) ∈ \bar Γ \text{ and } g₂ ∈ g₁\bar S₁
    \biggr\}.
\]
Clearly we have $\schemeclsY[S₁,S₂]{\stack X} \subseteq \schemecls[S₁]{\stack X}$ and $\schemeclsY[S] \stack X = \schemeclsY[S,S] \stack X$.

Consider the Cartesian square of closed embeddings
\[
    \begin{tikzcd}
        \schemelscY[S₁,S₂] \stack X \arrow[r, hook, "i_{S₁,S₂}^c"] \arrow[d, hook, "\schemei^{S₁,S₂}"] & \schemelscY\stack X \arrow[d, hook, "\schemei"] 
        \\
        \schemeclsY[S₁,S₂] \stack X \arrow[r, hook, "i_{S₁,S₂}"]   & \schemeclsY\stack X 
    \end{tikzcd}
\]

\begin{Lem}\label{lem:d-mod:key_for_stablizier}%
    For any $S₁ ⊆ S₂$ in $\Stab\stack X$ and any $\sheaf F ∈ \catDModHolMon{Γ}{G×G}$ we have
    \[
        \schemei^{S₁,S₂,*} i_{S₁,S₂}^! \bar\schemeq^! \schemej_! \sheaf F = 0.
    \]
\end{Lem}


\begin{proof}
    The scheme $\schemelsc[S₁,S₂] \stack X$ is given by
    \[
        \biggl\{
            \bigl(g₁,\, y,\, g₂\bigr) ∈ G × Y × \bar G : \schemeh(y) ∈ X^{S₂},\, \bigl(g₂,\, \schemeh(y),\, g₁\schemeh(y)\bigr) ∈ \bar Γ \text{ and } g₂ ∈ g₁(\bar S₁ \setminus S₁)
        \biggr\}.
    \]
    If $S₁ = \bar S₁$ the statement is trivially true.
    Otherwise the scheme $\bar S₁ \setminus S₁$ is the union of hyperplanes $H_i$ of $\bar S₁$.
    It suffices to prove the statement when further restricting to 
    \[
        \biggl\{
            \bigl(g₁,\, y,\, g₂\bigr) ∈ G × Y × \bar G : \schemeh(y) ∈ X^{S₂},\, \bigl(g₂,\, \schemeh(y),\, g₁\schemeh(y)\bigr) ∈ \bar Γ \text{ and } g₂ ∈ g₁H_i
        \biggr\}.
    \]
    for all $i$. 
    Let $H$ be one such hyperplane.
    We will assume that $H$ is contained in the closure of the connected component of $1 ∈ S₁$. 
    The proof for $H$ is a different component is the same, up to a shift by an element of $G$.
    Let $\schemei_H$ be the inclusion of
    \[
        Z = 
        \biggl\{
            \bigl(g₁,\, y,\, g₂\bigr) ∈ G × Y × \bar G : \schemeh(y) ∈ X^{S₂},\, \bigl(g₂,\, \schemeh(y),\, g₁\schemeh(y)\bigr) ∈ \bar Γ \text{ and } g₂ ∈ g₁H
        \biggr\}.
    \]
    into $\schemeclsY[S₁,S₂] \stack X$.
    We want to compute
    \[
        \schemei_H^{*} i_{S₁,S₂}^! \bar\schemeq^! \schemej_! \sheaf F.
    \]
    We will do so be introducing a contractive $\Gm$-action on $\bar Γ$ and $\schemelsY[S₁,S₂]\stack X$ such that the morphism
    \[
        κ ∘ i_{S₁,S₂}\colon \schemeclsY[S₁,S₂]\stack X → \bar Γ
    \]
    is $\Gm$-equivariant.

    We write $G \cong G₁ × S₁$ for some subgroup $G₁$ of $G$.
    This given a corresponding decomposition of the monad $\bar G \cong \as n$ as $\bar G = \bar G₁ \bar S₁$.
    Let $H' = \bar G₁ H$.
    We note that $G ∩ H' = \emptyset$.
    
    We chose an action $μ$ of $\Gm$ on $\bar S₁$ that contracts $\bar S₁$ onto $H$.
    This induces an action of $\Gm$ on $\bar G = \bar G₁ \bar S₁$ by $u \cdot ts = tμ(u,s)$, contracting $\bar G$ onto $H'$.
    Further we obtain an action of $\Gm$ on $\bar Γ$ that keeps the first $X$ coordinate fixed.
    By construction this action contracts $\bar Γ$ onto a closed subvariety of $\bar Γ \setminus Γ$.
    We will denote this subvariety by $Z₁$ and the contraction morphism $π₁\colon \bar Γ → Z₁$ by $π₁$.
    
    We can also lift the action to $\schemeclsY[S₁,S₂]\stack X$ where it contracts onto $Z$.
    We will denote the corresponding contraction morphism by $π\colon \schemeclsY[S₁,S₂]\stack X → Z$.
    The morphism $κ ∘ i_{S₁,S₂}\colon \schemeclsY[S₁,S₂]\stack X → \bar Γ$ is equivariant with respect to these $\Gm$-actions and on its image the action keeps the second $X$-coordinate fixed.

    We note that the D-modules $\schemej_!\sheaf F$ and $i_{S₁,S₂}^! \bar\schemeq^! \schemej_! \sheaf F$ are monodromic with respect to these $\Gm$-actions.
    The contraction principle Theorem~\ref{thm:d-mod:pre:contraction_principle} thus implies that
    \[
        \schemei_H^* i_{S₁,S₂}^! \bar\schemeq^! \schemej_! \sheaf F = π_* i_{S₁,S₂}^! \bar\schemeq^! \schemej_! \sheaf F.
    \]
    By construction, the square
    \[
        \begin{tikzcd}
            \schemecls[S₁,S₂] \stack X \arrow[r, "π"] \arrow[d, "\schemeq ∘ i_{S₁,S₂}"] & Z \arrow[d] \\
            \bar Γ \arrow[r, "π₁"] & Z₁
        \end{tikzcd}
    \]
    is Cartesian. 
    Let us call the right vertical map $f$.
    Base change yields
    \[
        π_* i_{S₁,S₂}^!\bar\schemeq^!\schemej_! \sheaf F = 
        f^!π_{1,*} \schemej_! \sheaf F.
    \]
    Finally, let $i_{Z₁}\colon Z₁ \hookrightarrow \bar Γ$ be the inclusion.
    Applying the contraction principle again we obtain
    \[
        f^!π_{1,*} \schemej_! \sheaf F =
        f^!i_{Z₁}^* \schemej_! \sheaf F =
        0.
        \qedhere
    \]
\end{proof}

\begin{proof}[Outline of proof of Theorem~\ref{thm:d-mod:torus:is-good}]
    Iterated Mayer-Vietoris argument using lemmas~\ref{lem:d-mod:stabilizers_cover} and~\ref{lem:d-mod:key_for_stablizier}.
    Note that if $S₁,\, S₂ ∈ \Stab\stack X$, then
    \[
        \schemeclsY[S₁]\stack X ∩ \schemeclsY[S₂]\stack X = 
        \schemeclsY[S₁∩S₂,\, S₁S₂].
    \]
    \todo{Add some details.}
\end{proof}
