\chapter{Prerequisites}

\begin{itemize}
    \item Everything over an algebraically closed field of characteristic $0$.
    \item Assumptions on stacks.
    \item Note on dg categories \cite{Keller:2006:OnDGCategories} and linear stable ($∞$,1)-categories \cite{Lurie:2014-draft:HigherAlgebra}.\todo{Why are they the same? Why are $A_∞$-algebras in vectors spaces over a field of characteristic $0$ the same as dg-algebras?}
\end{itemize}

\section{D-modules on stacks}

The second part of this thesis is primarily concerned with D-modules on quotient stacks.
Unfortunately there is currently no comprehensive source available that covers all the basic constructions and properties of D-modules on stacks (or even the \emph{dg category} of D-modules on schemes).
Thus we collect all the relevant properties (without proof) in this section.
The upshot is that the familiar \enquote{six functors formalism} essentially works for holonomic D-modules and schematic morphisms of stacks.

The category of D-modules on a stack $\stack X$ can be either constructed via descent \cite{BeilinsonDrifeld:unpublished:Hitchin,DrinfeldGaitsgory:2013:FinitenessQuestions} or equivalently as ind-coherent sheaves on the de Rham space of $\stack X$ \cite{GaitsgoryRozenblyum:2014:CrystalsAndDModules}.
While the first construction is more \enquote{hands on}, the second construction is often more useful from a theoretical point of view.
It is explained in detail in the upcoming book \cite{GaitsgoryRozenblyum:prelim:StudyInDAG} (see also \cite{FrancisGaitsgory:2012:ChiralKoszulDuality} for an overview).
Many basic properties of the category $\catDMod{\stack X}$ are explored in \cite{DrinfeldGaitsgory:2013:FinitenessQuestions} and most of the following assertions are taken from there.

For any morphism $f\colon \stack X → \stack Y$ the constructions yield a continuous functor $f^!\colon \catDMod{\stack Y} → \catDMod{\stack X}$ and (after some work) a not necessarily continuous functor $f_*\colon \catDMod{\stack X} → \catDMod{\stack Y}$.
If $p\colon \stack X → \pt$ is the structure map then we set
\[
    \ΓdR(\stack X,\, {-}) = p_*({-}) \colon \catDMod{\stack X} → \catVect.
\]
The functor $\ΓdR$ is representable by a D-module $k_{\stack X}$, i.e.
\[
    \ΓdR(\stack X,\, {-}) = \Hom_{\catDMod{\stack X}}(k_{\stack X},\, {-}).
\]
Again we note that $\ΓdR(\stack X,\, {-})$ is usually not continuous and hence the object $k_{\stack X}$ not compact.

Let $Δ\colon \stack X → \stack X × \stack X$ be the diagonal.
The category $\catDMod{\stack X}$ has a monoidal structure given by the tensor product
\[
    \sheaf F \otimes \sheaf G = Δ^!\bigl( \sheaf F \boxtimes \sheaf G \bigr).
\]
The unit for this monoidal structure is $ω_{\stack X} = p^! k$.

We will be mainly concerned with the subcategory of holonomic D-modules since they enjoy extended functoriality.
\begin{Def}
    A $D$-module $\sheaf F ∈ \catDMod{\stack X}$ is called \emph{holonomic} if $f^!\sheaf F$ is holonomic for any smooth morphism $f\colon Z → \stack X$ from a scheme $Z$.
    The full subcategory of holonomic D-modules will be denoted $\catDModHol{\stack X}$.
\end{Def}

The following assertions mostly follow from their corresponding counterparts for schemes.
We refer to \cite{Braverman:LecturesOnAlgebraicDmodules} for proofs in the case on non-smooth schemes.

\begin{Prop}
    Let $f\colon \stack X → \stack Y$ be a schematic morphism.
    Then $f^!$ and $f_*$ restrict to functors 
    \[
        f^!\colon \catDModHol{\stack Y} → \catDModHol{\stack X}
        \quad\text{and}\quad
        f_*\colon \catDModHol{\stack X} → \catDModHol{\stack Y}.
    \]
\end{Prop}

The Verdier duality functor on schemes induces an involutive anti auto-equivalence
\[
    \dualize_{\stack X}\colon \catDModHol{\stack X}^\mathrm{op} → \catDModHol{\stack X}
\]
such that for each smooth morphism $Z → \stack X$ of relative dimension $d$ from a scheme $Z$ one has
\[
    f^! ∘ \dualize_{\stack X} \cong \dualize_{Z} ∘ f^![-2d].
\]
The Verdier duality functor then allows us to define the \emph{non-standard functors} $f_!$ and $f^*$ for any schematic morphism $f\colon \stack X → \stack Y$ by
\begin{align*}
    f^* & = \dualize_{\stack X} ∘ f^! ∘ \dualize_{\stack Y} \colon \catDModHol{\stack Y} → \catDModHol{\stack X} \\
    \intertext{and}
    f_! & = \dualize_{\stack Y} ∘ f_* ∘ \dualize_{\stack X} \colon \catDModHol{\stack X} → \catDModHol{\stack Y}.
\end{align*}
We obtain adjoint pairs $(f_!,\, f^!)$ and $(f^*,\, f_*)$.
In particular we have 
\[
    k_{\stack X} = f^* k_{\stack Y}.
\]
In some situations we can identify the non-standard functors with their standard counterparts.
If $f$ is smooth of relative dimension $d$ then $f^* = f^![-2d]$.
If $f$ is proper then $f_! = f_*$ an in particular $f_*$ is left adjoint to $f^!$.
The objects $ω_{\stack X}$ and $k_{\stack X}$ are always holonomic and
\[
    \dualize_{\stack X} ω_{\stack X} = k_{\stack X}.
\]

We will make use of the following lemma which follows from \cite[Lemma~5.1.6]{DrinfeldGaitsgory:2013:FinitenessQuestions}.

\begin{Lem}
    For a smooth and schematic morphism $f$ the functor $f^!$ is conservative.
\end{Lem}

\begin{Prop}[{\cite[\RomanNum{III}.4.2.1.3]{GaitsgoryRozenblyum:prelim:StudyInDAG}}]
    \label{prop:d-mod:pre:base-change}%
    Consider a Cartesian square
    \[
        \begin{tikzcd}
            \stack Z \arrow[d, "p"] \arrow[r, "q"] & \stack X₁ \arrow[d, "f"] \\
            \stack X₂ \arrow[r, "g"] & \stack Y
        \end{tikzcd}
    \]
    with schematic morphism $f$ (and hence $p$).
    Then there is a base change isomorphism
    \[
        p_* q^! \isoto g^! f_*
    \]
    of functors from $\catDMod{\stack{X₁}}$ to $\catDMod{\stack{X₂}}$.
    If furthermore $f$ (and hence $p$) is proper, then this isomorphism coincides with the natural transformation
    \[
        p_* q^! →
        p_* q^! f^! f_* =
        p_* p^! g^! f_* →
        g^! f_*
    \]
    induced by $(f_*,\,f^!)$ and $(p_*,\, p^!)$ adjunctions.
\end{Prop}

\begin{Prop}
    \label{prop:d-mod:pre:projection-formula}%
    If $f\colon \stack X → \stack Y$ is a schematic morphism then the projection formula holds, i.e.~there is a functorial isomorphism
    \[
        \sheaf F \otimes f_*(\sheaf G) \cong f_*\bigl( f^! \sheaf F \otimes \sheaf G)
    \]
    for $\sheaf F ∈ \catDMod{\stack Y}$ and $\sheaf G ∈ \catDMod{\stack X}$.
\end{Prop}

\begin{Rem}
    Propositions \ref{prop:d-mod:pre:base-change} and \ref{prop:d-mod:pre:projection-formula} hold more generally when $f$ is merely a \enquote{safe} morphism.
    Alternatively they hold in full generality after replacing $f_*$ by the \enquote{renormalized de Rham pushforward}.
    We fill not use either notion in this thesis and refer the interested reader to \cite{DrinfeldGaitsgory:2013:FinitenessQuestions}.
\end{Rem}

For D-modules on stacks we have the usual recollement package.
Let $i\colon \stack Z \hookrightarrow \stack X$ be a closed embedding and $j\colon \stack U \hookrightarrow \stack X$ the complementary open.
We have adjoint pairs $(i_*,\, i^!)$ and $(j^!,\, j_*)$.

\begin{Prop}[{\cite[Section~2.5]{GaitsgoryRozenblyum:2014:CrystalsAndDModules}}]
    \label{prop:d-mod:recollement-std}%
    There is an exact triangle of functors
    \[
        i_*i^! → \id → j_*j^!
    \]
    on $\catDMod{\stack X}$, the adjunction morphisms
    \[
        \id → i^!i_*
        \quad\text{and}\quad
        j^!j_* → \id
    \]
    are isomorphisms, the functors $j^!i_*$ and $i^!j_*$ vanish and $i_*$ and $j_*$ are full embeddings.
\end{Prop}

On holonomic D-modules we have the additional adjoint pairs $(i^*,\, i_*)$ and $(j_!,\, j^*)$.
By applying duality to Proposition~\ref{prop:d-mod:recollement-std} we obtain the distinguished triangle
\[
    j_! j^* → \id → i_*i^*
\]
and the identity $i^*j_! = 0$ on holonomic D-modules.
Further, functor $j_!$ is a full embedding $\catDModHol{\stack U} \hookrightarrow \catDModHol{\stack X}$.

\begin{Def}
    \label{def:d-mod:pre:monodromic}%
    Let $X$ be a scheme with an action of an algebraic group $G$ and let $p\colon X → X/G$.
    The \emph{monodromic} subcategory $\catDModMon{X}{G} ⊆ \catDMod{X}$ is the subcategory generated by the essential image of $p^!\colon \catDMod{X/G} → \catDMod{X}$.
\end{Def}

\begin{Thm}[Contraction principle~{\cite[Proposition~3.2.2]{DrinfeldGaitsgory:2014:OnATheoremOfBraden}}]
    \label{thm:d-mod:pre:contraction_principle}%
    Let $X$ be a scheme with an action by $\Gm$ that extends to an action of the monoid $\as 1$.
    Let $i\colon X^0 \hookrightarrow X$ be the closed subscheme of $\Gm$-fixed points and let $π\colon X → X^0$ be the contraction morphism induced by the $\Gm$-equivariant morphism $\as 1 → \{0\}$.
    Then there is an isomorphism of functors
    \[
        i^* \cong π_* \colon \catDModMon{X}{\Gm} → \catDMod{X^0}.
    \]
\end{Thm}


\section{Monads}
\label{sec:d-mod:pre:monads}

We will deduce Theorem~\ref{thm:d-mod:main} from a isomorphism of monads on $\catDMod{\stack X}$.
In this section we give a short introduction to the theory of monads and the specific constructions that we will use.
However, in the interest of readability we will mainly do so informally, skipping over the intricacies of $∞$-categories.
The interested reader can find the correct $∞$-categorical formulations in the given references.

Thus we think of a \emph{monad} on a category $\cat C$ as consisting of a triple $(T, η, μ)$, where $T\colon \cat C → \cat C$ is an endofunctor of $\cat C$, and $η\colon \id_{\cat C} → T$ and $μ\colon T∘T → T$ are natural transformations that the diagrams
\begin{equation}
    \label{eq:d-mod:pre:monad-identities}
    \begin{tikzcd}
        T³ \arrow[r, "Tμ"] \arrow[d, "μT"'] & T² \arrow[d, "μ"] \\
        T² \arrow[r, "μ"'] & T
    \end{tikzcd}
    \quad\text{and}\quad
    \begin{tikzcd}
        T \arrow[r, "Tη"] \arrow[d, "ηT"'] \arrow[dr, equal] & T² \arrow[d, "μ"] \\
        T² \arrow[r, "μ"'] & T
    \end{tikzcd}
\end{equation}
commute.
Alternatively, we can think of $T$ being a monoid in the category of endofunctors of $\cat C$ with the monoidal structure given by composition of endofunctors.
This definition also gives the correct generalization to $∞$-categories \cite[Definition~4.7.0.1]{Lurie:2014-draft:HigherAlgebra}.

Let $X$ be an object of the category $\cat C$.
Then $T$ gives the vector space $\Hom_{\cat C}(X, TX)$ the structure of an algebra with multiplication map
\[
    (f,g) \mapsto μ_X ∘ Tf ∘ g,
\]
\[
    \begin{tikzcd}
        X \arrow[r, "g"] & TX \arrow[r, "Tf"] & T²X \arrow[r, "μ_X"] & TX.
    \end{tikzcd}
\]
The identities~\ref{eq:d-mod:pre:monad-identities} ensure that the algebra is associative and unital.\todo{Actually in the $∞$-categorical setting we should obtain an $A_∞$-algebra.}\todo{Put this into my notes on monads.}

\begin{itemize}
    \item monads from adjunction
\end{itemize}

\begin{Def}
    A \emph{groupoid} $\mathcal G$ in $\cat{Stacks}$ consists of a stack $G₀$ of \enquote{objects} and a stack $G₁$ of \enquote{morphisms} together with
    \begin{itemize}
        \item \emph{source} and \emph{target} maps $s,t\colon G₁ \rightrightarrows G₀$,
        \item a \emph{unit} $e\colon G₀ → G₁$,
        \item a \emph{multiplication} (or \emph{composition}) map $m\colon G₁ ×\limits_{s,G₀,t} G₁ → G₁$),
        \item a \emph{inverse} map $ι\colon G₁ → G₁$,
    \end{itemize}
    such that
    \begin{itemize}
        \item $s ∘ e = t ∘ e = \id_{G₀}$,
        \item $s ∘ m = s ∘ p₂$ and $t ∘ m = t ∘ p₁$ (where $p_i\colon G₁ ×_{s,G₀,t} G₂$ are the projection maps).
        \item $m$ is associative,
        \item $ι$ interchanges $s$ and $t$ and is an inverse for $m$.
    \end{itemize}
\end{Def}

\begin{Ex}
    For our purpose the most important example is the following:
    Let $f\colon X → S$ be a map in $\cat{Stacks}$.
    We set $G_0 = X$ and $G₁ = X ×_S X$.
    The source and target maps are given by $p₁$ and $p₂$, the unit by the diagonal $Δ\colon X → X×_SX$, the inverse by interchanging the factors and multiplication is $p₁₃\colon X ×_S X ×_S X → X×_SX$.
\end{Ex}

Let us for the moment assume that $s$ (and hence $t$) is proper and schematic.
In this case the maps $e$ and $m$ are also proper, since $s ∘ e = \id_{G₀}$ and $s ∘ m = s ∘ p₂$ are proper [ToDo: reference].
In particular the functors $e^!\colon \catDMod{G₁} → \catDMod{G₀}$ and $m^!\colon \catDMod{G₁} → \catDMod{G₁ ×_{G₀} G₁}$ have left adjoints given by $e_*$ and $m_*$ respectively.
This allows us to give the endofunctor $T = s_*t^!$ of $\catDMod{G₀}$ the structure of a monad in the following way:

\begin{itemize}
    \item By $(e_*,e^!)$-adjunction we have a transformation
        \[
            \id = (s∘e)_*(t∘e)^! = s_*e_*e^!t^! → s_*t^! = T.
        \]
    \item Consider the following commutative diagram
        \[
            \begin{tikzcd}[column sep=small]
                {} & & G₁ \arrow[dddll, bend right, "s"] \arrow[dddrr, bend left, "t"] & & \\
                & & G₁ ×_{G₀} \arrow[u, "m"] \arrow[dl, "p₂"] \arrow[dr, "p₁"] G₁ & & \\
                & G₁ \arrow[dl, "s"] \arrow[dr, "t"] & & G₁ \arrow[dl, "s"] \arrow[dr, "t"] & \\
                G₀ & & G₀ & & G₀
            \end{tikzcd}
        \]
        with Cartesian middle square.
        Proper base change and $(m_*,m^!)$-adjunction gives a transformation
        \[
            T² =
            s_*t^!s_*t^! =
            (s∘p₂)_*(t∘p₁)^! =
            (s∘m)_*(t∘m)^! =
            s_*m_*m^!t^! →
            s_*t^! =
            T.
        \]
\end{itemize}

\begin{itemize}
    \item this is actually a monad
    \item base change morphism from groupoid monad ($X ×_S X$) to adjunction monad (proper case)
    \item monads from groupoids (general case): \cite[Lemma~II.1.7.1.4]{GaitsgoryRozenblyum:prelim:StudyInDAG}, \cite[Section~4.7.6]{Lurie:2014-draft:HigherAlgebra}
\end{itemize}

\section{Hochschild cohomology}

\begin{itemize}
    \item Co-complete categories and continuous functors
    \item Definition via $\Hom_{\cat{Funct}_{\text{(cont)}}}(\id, \id)$.
    \item Continuous functors and kernels.
    \item The case of D-modules: via kernel; adjunction monad; algebra structure is the one induced from the adjunction monad.
\end{itemize}
