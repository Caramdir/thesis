\chapter{Measuring subvarieties}

\begin{Assumption}
    In this chapter we will always assume that $p$ is a monotone and comonotone perversity function.
    Then Theorem~\ref{thm:perverse-t-structure} guarantees the existence the perverse t-structure on $D_c^b(X)^G$.
\end{Assumption}

\section{Some reformulations}

In this  section we will give some reformulations of the perverse t-structure from Definition~\ref{def:perverse-t-structure}.
The equivalent conditions are inspired by Kashiwara's definition of a (non-equivariant) perverse t-structure on $D_c^b(X)$ in~\cite{Kashiwara:2004:tStructureOnHolonomicDModuleCoherentOModules}.

% TODO: Do we actually need the comonotonicity assumption (i.e. the t-structure?)
\begin{Prop}\label{prop:equivDeligneKashiwara:le}%
    Let $\sheaf F ∈ D_c^b(X)^G$.
    The following are equivalent:
    \begin{enumerate}
        \item \label{li:prop:equivDeligneKashiwara:le:1}%
            $\sheaf F ∈ \perv D^{≤0}(X)^G$, i.e.\ $\mathbf ι_x^*\sheaf F ∈ D^{≤p(x)}(\catModules{\O_x})$ for all $x ∈ \Xtop$;
        \item \label{li:prop:equivDeligneKashiwara:le:2}%
            $p(\dim \supp H^{k}(\sheaf F)) ≥ k$ for all $k$.
    \end{enumerate}
\end{Prop}

A crucial fact that we will implicitly use quite often in the following arguments is that the support of a coherent sheaf is always closed.
In particular, this means that if $x$ is a generic point and $\sheaf F$ a coherent sheaf, then $\mathbf ι_x^* \sheaf F = 0$ if and only if $\res{\sheaf F}U = 0$ for some open set $U$ intersecting $\overline x$.

\begin{proof}
    First let $\sheaf F ∈ \perv D^{≤0}(X)^G$ and assume for contradiction that there exists an integer $k$ such that $p(\dim \supp H^{k}(\sheaf F)) < k$.
    Let $x$ be the generic point of an irreducible component of maximal dimension of $\supp H^{k}(\sheaf F)$.
    Then $H^k(\mathbf ι_x^* \sheaf F) \ne 0$. 
    But on the other hand, $\mathbf ι_x^*\sheaf F ∈ D^{≤p(x)}(\catModules{\O_x})$ and $p(x) = p(\dim \supp H^{k}(\sheaf F)) < k$, yielding a contradiction.

    Conversely assume that $p(\dim \supp H^{k}(\sheaf F)) ≥ k$ for all $k$ and let $x ∈ \Xtop$.
    If $H^k(\mathbf ι_x^*\sheaf F) \ne 0$, then $\dim x ≤ \dim \supp H^{k}(\sheaf F)$.
    Thus monotonicity of the perversity implies that $\sheaf F ∈ \perv D^{≤0}(X)^G$.
\end{proof}

% TODO: Where do we use comonotonicity (just for definition of the t-structure? Do we actually need the t-structure?).
\begin{Prop}\label{prop:equivDeligneKashiwara:ge}%
    Let $\sheaf F ∈ D_c^b(X)^G$ and let $p$ be strictly monotone (in addition to our standard comonotonicity assumption).
    \begin{enumerate}
        \item \label{li:prop:equivDeligneKashiwara:ge:1}%
            $\sheaf F ∈ \perv D^{\ge 0}(X)^G$, i.e.\ $\mathbf ι_x^!\sheaf F ∈ D^{≥p(x)}(\catModules{\O_x})$ for all $x ∈ \Xtop$;
        \item \label{li:prop:equivDeligneKashiwara:ge:2}%
            $\lc {\overline x}\sheaf F ∈ D^{≥p(x)}(X)$ for all $x ∈ \Xtop$;
        \item \label{li:prop:equivDeligneKashiwara:ge:3}%
            $\lc {Y}\sheaf F ∈ D^{≥p(\dim Y)}(X)$ for all $G$-invariant closed subvarieties $Y$ of $X$;
        \item \label{li:prop:equivDeligneKashiwara:ge:4}%
            $\dim\left( \overline x ∩ \supp\left( H^k(\dualize \sheaf F) \right) \right) ≤ -p(x) - k$ for all $x ∈ \Xtop$ and all $k$.
    \end{enumerate}
\end{Prop}

\begin{proof}
    The implications from \ref{li:prop:equivDeligneKashiwara:ge:3} to \ref{li:prop:equivDeligneKashiwara:ge:2} and \ref{li:prop:equivDeligneKashiwara:ge:2} to \ref{li:prop:equivDeligneKashiwara:ge:1} are trivial and the equivalence of \ref{li:prop:equivDeligneKashiwara:ge:2} and \ref{li:prop:equivDeligneKashiwara:ge:4} follows from Lemma~\ref{lem:supportAndLocalCohomology+} below.
    Thus we only need to show that \ref{li:prop:equivDeligneKashiwara:ge:1} implies \ref{li:prop:equivDeligneKashiwara:ge:3}.
    So assume that $\sheaf F ∈ \perv D^{≥0}(X)^G$.
    We induct on the dimension of $Y$.
    
    If $\dim Y = 0$, then $Γ(X,\lc Y \sheaf F) = \bigoplus_{y ∈ \Xtop[Y]} \mathbf ι_y^!\sheaf F$ and thus $\lc Y\sheaf F ∈ D^{≥p(0)}(X)$ by assumption.

    Now let $\dim Y > 0$.
    We first assume that $Y$ is irreducible with generic point $x ∈ \Xtop$.
    Let $k$ be the smallest integer such that $H^k(\lc {\overline x} \sheaf F) \ne 0$ and assume that $k < p(x)$.
    We will show that this implies that $H^k(\lc {\overline x}\sheaf F) = 0$, giving a contradiction.

    We first show that $H^k(\lc {\overline x}\sheaf F)$ is coherent.
    Let $j\colon X \setminus {\overline x} \hookrightarrow X$ and consider the distinguished triangle
    \[
        \lc {\overline x} \sheaf F → \sheaf F → j_*j^* \sheaf F \xrightarrow{+1}.
    \]
    Applying cohomology to it we get an exact sequence
    \[
        H^{k-1}(j_*j^*\sheaf F) → H^k(\lc{\overline x} \sheaf F) → H^k(\sheaf F).
    \]
    By assumption, $k-1 \le p(x) - 2$, so that $H^{k-1}(j_*j^*\sheaf F)$ is coherent by the Grothendieck Finiteness Theorem in the form of \cite[Corollary~3]{Bezrukavnikov:arXiv:PerverseCoherentSheaves}.
    As $H^k(\sheaf F)$ is coherent by definition, this implies that $H^k(\lc{\overline x} \sheaf F)$ also has to be coherent.

    Set $Z = \supp H^k(\lc {\overline x}\sheaf F)$.
    Then, since $ι_x^* H^k(\lc {\overline x}\sheaf F) = H^k(\mathbf ι_x^! \sheaf F)$ vanishes, $Z$ is a proper closed subset of $\overline x$.
    We consider the distinguished triangle
    \[
        H^k(\lc {\overline x}\sheaf F)[-k] →
        \lc {\overline x}\sheaf F →
        τ_{>k}\lc {\overline x}\sheaf F \xrightarrow{+1},
    \]
    and apply $\lc Z$ to it:
    \[
        \lc Z H^k(\lc {\overline x}\sheaf F)[-k] =
        H^k(\lc {\overline x}\sheaf F)[-k] →
        \lc Z \sheaf F →
        \lc Z τ_{>k}\lc {\overline x}\sheaf F \xrightarrow{+1}.
    \]
    Since $\dim Z < \dim x$, we can use the induction hypothesis and monotonicity of $p$ to deduce that $\lc Z \sheaf F$ is in degrees at least $p(\dim Z) \ge p(x) > k$.
    Clearly $\lc Z τ_{>k}\lc {\overline x}\sheaf F$ is also in degrees larger than $k$.
    Hence $H^k(\lc {\overline x}\sheaf F)$ has to vanish.

    If $Y$ is not irreducible, let $Y₁$ be an irreducible component of $Y$ and $Y₂$ be the union of the other components.
    Then there is a Mayer-Vietoris distinguished triangle
    \[
        \lc {Y₁\cap Y₂} \sheaf F → \lc {Y₁} \sheaf F \oplus \lc{Y₂}\sheaf F → \lc{Y} \sheaf F \xrightarrow{+1},
    \]
    where $\lc {Y₁\cap Y₂} \sheaf F ∈ D^{\ge p(\dim Y₁\cap Y₂)}(X) \subseteq D^{\ge p(\dim Y)+1}$ (by the induction hypothesis and strict monotonicity of $p$) and $\lc{Y₁} \sheaf F$ and $\lc{Y₂} \sheaf F$ are in $D^{\ge p(\dim Y)}(X)$ by induction on the number of components of $Y$.
    Thus $\lc Y \sheaf F ∈ D^{\ge p(\dim Y)}$ as required.
\end{proof}

\begin{Lem}[{\cite[Proposition~5.2]{Kashiwara:2004:tStructureOnHolonomicDModuleCoherentOModules}}]%
    \label{lem:supportAndLocalCohomology+}%
    Let $\sheaf F ∈ D_c^b(X)$, $Z$ a closed subset of $X$, and $n$ an integer.
    Then $\lc Z\sheaf F ∈ D_{qc}^{≥n}(X)$ if and only if $\dim(Z∩\supp(H^k(\dualize \sheaf F))) \le - k - n$ for all $k$.
\end{Lem}

This lemma extends \cite[Proposition~5.2]{Kashiwara:2004:tStructureOnHolonomicDModuleCoherentOModules} to singular varieties.
The proof is same as for the smooth case, but we will include it here for completeness.

\begin{proof}
    By~\cite[Proposition~\textsc{vii}.1.2]{SGA2}, $\lc Z\sheaf F ∈ D_{qc}^{\ge n}(X)$ if and only if 
    \begin{equation}
        \label{eq:supportAndCohomology+}%
        \sheafHom(\sheaf G,\sheaf F) ∈ D_c^{\ge n}(X)
    \end{equation}
    for all $\sheaf G ∈ \catCoh{X}$ with $\supp \sheaf G \subseteq Z$.
    Let $d(n) = -n$ be the dual standard perversity.
    Then by~\cite[Lemma~5a]{Bezrukavnikov:arXiv:PerverseCoherentSheaves}, \eqref{eq:supportAndCohomology+} holds if and only if $\dualize \sheafHom(\sheaf G,\sheaf F) ∈ \perv[d] D^{\le -n}(X)$.
    By~\cite[Proposition~\textsc{v}.2.6]{Hartshorne:1966:ResiduesAndDuality}, $\dualize \sheafHom(\sheaf G,\sheaf F) = \sheaf G \otimes_{\O_X} \dualize \sheaf F$, so that by Proposition~\ref{prop:equivDeligneKashiwara:le} we need to show that
    \[
        \dim \supp H^{k}\left(\sheaf G \otimes_{\O_X} \dualize \sheaf F\right) \le - k - n 
    \]
    for all $k$.
    By~\cite[Lemma~5.3]{Kashiwara:2004:tStructureOnHolonomicDModuleCoherentOModules} (whose proof does not use the smoothness assumption) this is equivalent to
    \[
        \dim \left(Z∩\supp H^{k}(\dualize \sheaf F)\right) \le - k - n
    \]
    for all $k$, completing the proof.
\end{proof}


\section{Perverse coherent sheaves via measuring subvarieties}

\begin{Assumption}
    From now on we will assume that the $G$-action on $X$ has finitely many orbits.
\end{Assumption}

\begin{Def}
    Let $p$ be a perversity.
    A \emph{$p$-measuring subvariety} of $X$ is a closed subvariety $Z$ of $X$ such that 
    \[
        \dim(\overline x ∩ Z) = \dim x + p(x)
    \]
    for each $x ∈ \Xtop$ with $\overline x ∩ Z \ne \emptyset$. 
    If in addition $\overline x \cap Z$ is a set-theoretic local complete intersection in $\overline x$ for each $x ∈ \Xtop$, then $Z$ is called a \emph{\lciname} $p$-measuring subvariety.
    A \emph{(\lciname) $p$-measuring collection of subvarieties} of $X$ is a collection $\measuringFam$ of (\lciname) $p$-measuring subvarieties $Z$ such that for each $x ∈ \Xtop$ there exists $Z ∈ \measuringFam$ with $\overline x \cap Z \ne \emptyset$.
\end{Def}

\begin{Rem}
    Let $Z$ be a $p$-measuring subvariety.
    The condition on $p$-measuring subvarieties can be rewritten as $\dim(\overline x ∩ Z) = - \bar p(x)$ and $\codim_{\overline x}(\overline x ∩ Z)= -p(x)$.
    Thus comonotonicity of $p$ ensures that if $\dim y ≤ \dim x$ then $\dim (\overline y ∩ Z) ≤ \dim (\overline x ∩ Z)$.
    Monotonicity of $p$ then further says that $\codim_{\overline y}(\overline y ∩ Z) \le \codim_{\overline x}(\overline x ∩ Z)$.

    We clearly have $0 \le \dim(\overline x ∩ Z) \le \dim x$ and hence $-\dim x \le p(x) \le 0$.
    We will show in Theorem~\ref{thm:existance_of_lcimeasuring} that the condition $-\dim x \le p(x) \le 0$ is sufficient for the existence of a \lciname\ $p$-measuring collection, at least when $X$ is affine.
\end{Rem}

% Warning: the conditions might be mixed up.
\begin{Thm}\label{thm:main}%
    Let $p$ be a strictly monotone and (not necessarily strictly) comonotone perversity on $X$.
    Let $\sheaf F \in D_c^b(X)^G$.
    \begin{enumerate}
        \item\label{li:thm:main:ge}%
            Assume that $X$ has a $p$-measuring collection $\measuringFam$.
            Then the following are equivalent.
            \begin{enumerate}
                \item $\sheaf F \in \perv D^{≥0}(X)^G$;
                \item $i_Z^!\sheaf F \in D^{≥0}(Z)$ for all $Z ∈ \measuringFam$;
                \item $\lc Z \sheaf F \in D^{≥0}(Z)$ for all $Z ∈ \measuringFam$.
            \end{enumerate}
        \item\label{li:thm:main:le-weak}%
            Assume that $X$ has a $\bar p$-measuring collection $\measuringFam$.
            Then the following are equivalent.
            \begin{enumerate}
                \item $\sheaf F \in \perv D^{≤0}(X)^G$;
                \item $\lc{z}i_Z^*\sheaf F \in D^{≤0}(Z)$ for all $Z ∈ \measuringFam$ and all $z ∈ Z$.
            \end{enumerate}
        \item\label{li:thm:main:le-lci}%
            Assume that $X$ has a \lciname\ $p$-measuring collection $\measuringFam$.
            Then the following are equivalent.
            \begin{enumerate}
                \item $\sheaf F \in \perv D^{≤0}(X)^G$;
                \item $\lc Z \sheaf F \in D^{≤0}(Z)$ for all $Z ∈ \measuringFam$.
            \end{enumerate}
    \end{enumerate}
    In particular, if $X$ has a \lciname\ $p$-measuring collection $\measuringFam$, then $\sheaf F$ is perverse with respect to $p$ if and only if $\lc Z\sheaf F$ is cohomologically concentrated in degree $0$ for each $Z ∈ \measuringFam$.
\end{Thm}

% TODO: Reformulate the arguments in this proof. It is slightly convoluted.
% TODO: Equivalence with (c).
\begin{proof}[Proof of Theorem~\ref{thm:main}\ref{li:thm:main:ge}]
    By Proposition~\ref{prop:equivDeligneKashiwara:ge}, $\sheaf F ∈ \perv D^{≥0}(X)^G$ if and only if
    \begin{align}
        \label{eq:main:+supp1}%
        & \dim\left( \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) ≤ -p(x) - k &&  \text{for all $x ∈ \Xtop$ and all $k$}. \\
        %
        \intertext{Using Lemma~\ref{lem:supportAndLocalCohomology+} for $\lc Z\sheaf F ∈ D^{≥0}(X)$, we see that we have to show the equivalence of \eqref{eq:main:+supp1} with}
        %
        \notag
        & \dim\left( Z ∩ \supp\left( H^k(\dualize F) \right) \right) ≤ - k && \text{ for all $k$ and all $Z ∈ \measuringFam$}. \\
        %
        \intertext{Since there are only finitely many orbits, this is in turn equivalent to}
        %
        \label{eq:main:+supp2}%
        & \dim\left( Z ∩ \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) ≤ - k && \text{ $\forall\, x ∈ \Xtop$, $k$ and $Z ∈ \measuringFam$}.
    \end{align}
    We will show the equivalence for each fixed $k$ separately.
    Let us first show the implication from \eqref{eq:main:+supp1} to \eqref{eq:main:+supp2}.
    Since $H^k(\dualize \sheaf F)$ is $G$-equivariant and there are only finitely many $G$-orbits, it suffices to show \eqref{eq:main:+supp2} assuming that $\dim x \le \dim \supp H^k(\dualize F)$ and $\overline x \cap \supp H^k(\dualize F) \ne \emptyset$.
    Then $\dim\left(\overline x ∩ \supp\left( H^k(\dualize F) \right)\right) = \dim \overline x$.
    Thus,
    \begin{multline*}
        \dim\left(Z ∩ \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) \le
        \dim(Z ∩ \overline x) =
        p(x) + \dim x = \\
        p(x) + \dim\left(\overline x ∩ \supp\left( H^k(\dualize F) \right)\right) \le
        p(x) - p(x) - k
        = -k.
    \end{multline*}
    
    Conversely, assume that \eqref{eq:main:+supp2} holds for $k$.
    If $\overline x \cap \supp H^k(\dualize F) = \emptyset$, then \eqref{eq:main:+supp1} is trivially true.
    Otherwise choose a $p$-measuring $Z$ that intersects $\supp H^k(\dualize F)$.
    First assume that $\overline x$ is contained in $\supp H^k(\dualize F)$.
    Then
    \begin{multline*}
        \dim\left(\overline x ∩ \supp\left( H^k(\dualize F) \right)\right) =
        \dim x =
        -p(x) + \dim(Z ∩ \overline x) = \\
        -p(x) + \dim\left(Z ∩ \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) \le
        -p(x) - k.
    \end{multline*}
    Otherwise $\overline x ∩ \supp\left( H^k(\dualize F) \right) = \overline y$ for some $y ∈ \Xtop$ with $\dim y < \dim x$.
    Then \eqref{eq:main:+supp1} holds for $y$ in place of $x$ and hence
    \[
    \dim\left( \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) =
    \dim\left( \overline y ∩ \supp\left( H^k(\dualize F) \right) \right) ≤
    -p(y) - k ≤
    -p(x) - k
    \]
    by monotonicity of $p$.
\end{proof}

% TODO: Some transitional text.

\begin{proof}[Proof of Theorem~\ref{thm:main}\ref{li:thm:main:le-weak}]
    % TODO: The actual proof (using duality).
\end{proof}

The following lemma encapsulates the central argument of the proof of the remaining part of Theorem~\ref{thm:main}.

\begin{Lem}\label{lem:supportAndLocalCohomology-}%
    Let $\sheaf F ∈ \catCoh{X}^G$ be a $G$-equivariant coherent sheaf on $X$, let $p$ be a monotone perversity and let $n$ be an integer.
    Assume that $X$ has enough $p$-measuring subvarieties and let $\measuringFam$ be a $p$-measuring family of subvarieties of $X$.
    Then the following are equivalent:
    \begin{enumerate}
        \item $p(\dim \supp \sheaf F) ≥ n$;
        \item \label{li:lem:supportAndLocalCohomology-:2}%
            $H^i(\lc Z\sheaf F) = 0$ for all $i ≥ -n+1$ and all $Z ∈ \measuringFam$.
    \end{enumerate}
\end{Lem}

\begin{proof}
    Since $\supp \sheaf F$ is always a union of the closure of orbits, we can restrict to the support and assume that $\supp \sheaf F = X$.

    First assume that $p(\dim X) = p(\dim \supp \sheaf F) ≥ n$.
    Using a Mayer-Vietoris argument it suffices to check condition \ref{li:lem:supportAndLocalCohomology-:2} in the case that $X$ is irreducible.
    By the definition of a $p$-measuring subvariety and monotonicity of $p$, this implies that, up to radical, $Z$ can be locally defined by at most $-n$ equations.
    Thus $H^i(\lc Z\sheaf F) = 0$ for $i > -n$ \cite[Theorem~3.3.1]{BrodmannSharp:1998:LocalCohomology}. 

    Now assume conversely that $H^i(\lc Z\sheaf F) = 0$ for all $i ≥ -n+1$ and all measuring subvarieties $Z ∈ \measuringFam$.
    We have to show that $p(\dim X) ≥ n$.
    Set $d = \dim X$.
    Choose any $p$-measuring subvariety $Z ∈ \measuringFam$ that intersects a maximal component of $X$ non-trivially.
    Then $\codim_X Z = -p(d)$.
    We will show that $H^{-p(d)}(\lc Z \sheaf F) \ne 0$ and hence $p(d) \ge n$ by assumption.
    Take some affine open subset $U$ of $X$ such that $U \cap Z$ is non-empty, irreducible and of codimension $-p(d)$ in $U$.
    It suffices to show that the cohomology is non-zero in $U$.
    Thus we can assume without loss of generality that $X$ is affine, say $X = \Spec A$, and $Z$ is irreducible.
    Write $Z = V(\ideal p)$ for some prime ideal $\ideal p$ of $A$.
    By flat base change~\cite[Theorem~4.3.2]{BrodmannSharp:1998:LocalCohomology},
    \[
    Γ(X,H^{-p(d)}(\lc Z \sheaf F))_{\ideal p} = 
    \left(H_{\ideal p}^{-p(d)}(Γ(X,\sheaf F))\right)_{\ideal p} =
    H_{\ideal p_{\ideal p}}^{-p(d)}(Γ(X,\sheaf F)_{\ideal p})
    \]
    Since $\dim \supp \sheaf F = \dim X = d$, the dimension of the $A_{\ideal p}$-module $Γ(X,\sheaf F)_{\ideal p}$ is $-p(d)$.
    Thus by the Grothendieck non-vanishing theorem~\cite[Theorem~6.1.4]{BrodmannSharp:1998:LocalCohomology}
    %\cite[Théorème~V.3.1]{SGA2}
    $H_{\ideal p_{\ideal p}}^{-p(d)}(Γ(X,\sheaf F)_{\ideal p}) \ne 0$ and hence $Γ(X,H^{-p(d)}(\lc Z \sheaf F)) \ne 0$ as required.
\end{proof}

\begin{proof}[Proof of Theorem~\ref{thm:main}\ref{li:thm:main:le-lci}]
    We use the description of $\perv[p] D^{≤0}(X)^G$ given by Proposition~\ref{prop:equivDeligneKashiwara:le}, i.e.
    \[
    \perv D^{≤0}(X)^G = \left\{ \sheaf F ∈ D_c^b(X)^G : p\left(\dim\left( \supp H^{n}(\sheaf F) \right)\right) ≥ n \text{ for all $n$}\right\}.
    \]
    We induct on the largest $k$ such that $H^k(\sheaf F) \ne 0$ to show that $\sheaf F ∈ \perv D^{≤0}(X)^G$ if and only if $\lc Z\sheaf F ∈ D^{≤0}(X)$ for all $p$-measuring subvarieties $Z ∈ \measuringFam$.

    The equivalence is trivial for $k \ll 0$.
    For the induction step note that there is a distinguished triangle
    \[
    τ_{<k} \sheaf F → \sheaf F → H^k(\sheaf F)[-k] \xrightarrow{+1}.
    \]
    Applying the functor $\lc Z$ and taking cohomology we obtain an exact sequence
    \begin{multline*}
        \cdots →
        H¹(\lc Z(τ_{<k} \sheaf F)) →
        H¹(\lc Z\sheaf F) →
        H^{k+1}(\lc Z(H^k(\sheaf F))) → \\
        H²(\lc Z(τ_{<k} \sheaf F)) →
        H²(\lc Z\sheaf F) →
        H^{k+2}(\lc Z(H^k(\sheaf F))) →
        \cdots.
    \end{multline*}
    By induction, $H^j(\lc Z(τ_{<k} \sheaf F))$ vanishes for $j ≥ 1$ so that $H^j(\lc Z\sheaf F) \cong H^{k+j}(\lc Z(H^k(\sheaf F)))$ for $j ≥ 1$.
    Thus the statement follows from Lemma~\ref{lem:supportAndLocalCohomology-}.
\end{proof}

\section{Existence of \lciname\ measuring subvarieties}

Of course, for Theorem~\ref{thm:main} to have any content, one needs to show that $X$ has enough $p$-measuring subvarieties.
The next theorem shows that at least for affine varieties there are always enough measuring subvarieties whenever $p$ satisfies the obvious conditions (see Remark~\ref{rem:existence}).

\begin{Thm}\label{thm:existance}%
    Assume that $X$ is affine and the perversity $p$ is monotone and comonotone and satisfies $-n \le p(n) \le 0$ for $n ∈ \{0,\dotsc,\dim X\}$.
    Then $X$ has enough $p$-measuring subvarieties.
\end{Thm}

\begin{proof}
    Let $X = \Spec A$.
    We induct on the dimension $d$.
    More precisely, we induct on the following statement:
    \begin{quote}
        There exists a closed subvariety $Z_d$ of $X$ such that for all $x ∈ \Xtop$ the following holds:
        \begin{itemize}
            \item $Z_d \cap \overline x \ne \emptyset$ and $Z_d \cap \overline x$ is a set-theoretic local complete intersection in $\overline x$;
            \item if $\dim x \le d$, then $\dim(\overline x ∩ Z_d) = p(x) + \dim x$;
            \item if $\dim x > d$, then $\dim(\overline x ∩ Z_d) = p(d) + \dim x$.
        \end{itemize}
    \end{quote}
    We set $p(-1) = 0$.
    The statement is trivially true for $d = -1$, e.g.~take $Z = X$.
    Assume that the statement is true for some $d \ge -1$.
    We want to show it for $d+1 \le \dim X$.

    If $p(d) = p(d+1)$, then $Z_{d+1} = Z_{d}$ works.
    Otherwise, by (co)monotonicity, $p(d+1) = p(d) - 1$.
    Set $S = \bigcup \{ \overline x ∈ \Xtop : \dim x \le d\}$.
    Since there are only finitely many orbits, we can choose a function $f$ such that $f$ vanishes identically on $S$, $V(f)$ does not share a component with $Z_d$ and $V(f)$ intersects every $\overline x$ with $\dim x > d$.
    Then $Z_{d+1} = Z_d \cap V(f)$ satisfies the conditions.
\end{proof}

