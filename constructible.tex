\chapter{Perverse constructible sheaves}

In this chapter we will consider a complex manifold $X$ together with a stratification $\setset S$ by complex submanifold.
We let $D_{\setset S}^b(X)$ be the bounded derived category of $\setset S$-constructible sheaves on $X$.
Recall that there is a \emph{middle perverse} t-structure on $D_{\setset S}^b(X)$, given by
\begin{equation*}
%    \label{eq:def:perverse:bbd}
    \begin{aligned}
        \perv D_{\setset S}^{\le 0}(X) & = \{ \sheaf F ∈ D^b_{\setset S}(X) : H^n(i_S^*\sheaf F) = 0 \text{ for all $n > -\frac12 \dim S$ and all $S ∈ \setset S$}\}; \\
        \perv D_{\setset S}^{\ge 0}(X) & = \{ \sheaf F ∈ D^b_{\setset S}(X) : H^n(i_S^!\sheaf F) = 0 \text{ for all $n < -\frac12 \dim S$ and all $S ∈ \setset S$}\}.
    \end{aligned}
\end{equation*}
In Section~\ref{sec:constructible_and_Lagrangian} we will make Theorem~\ref{thm:motivation} precise and give a proof.
In Section~\ref{sec:constructible_main_thm} we will formulate and prove a precise analogue of Theorem~\ref{thm:main} in the constructible setting.

\section{Perverse sheaves and Lagrangians}\label{sec:constructible_and_Lagrangian}

This section follows the exposition of \cite[Section 2.2]{Jin:arXiv:HolomorphicLagrangianBranesCorrespondToPerverseSheaves}.

We let
\[
    Λ_{\setset S} = \bigcup_{S ∈ \setset S} T^*_S X \subseteq T^*X
\]
be the standard conical Lagrangian associated to the stratification $\setset S$.

\begin{Def}[{\cite[Definition~4.2.7]{Dimca:2004:SheavesInTopology}}]
    Let $\setset S$ be a Whitney stratification of $X$ and $f\colon X → ℂ$ holomorphic.
    The \emph{stratified critical locus} of $f$ is
    \[
        Σ_{\setset S}(f) =
        \bigcup_{X_α ∈ \setset S} Σ(\res{f}{X_α}),
    \]
    where $Σ(\res{f}{X_α})$ is the (ordinary) critical locus of the restriction of $f$ to $X_α$.
\end{Def}

In the following we call a triple $(x, ξ, F)$ consisting of a smooth point $(x, ξ) ∈ Λ_{\setset S}$ and the germ of a holomorphic function $F$ at $x$ such that $F(x) = 0$, $d(\Re F)_x = ξ$\todo{Complex vs.~real cotangent space?}\ and the graph $Γ_{\Re F}$ is transverse to $Λ_{\setset S}$ at $(x, ξ)$ a \emph{test triple}.
We will assume that $F$ is defined on a ball $B_{2ε}(x)$ and with $ε$ small enough that $B_ε(x) ∩ Σ_{\setset S}(F) = \{x\}$.

\begin{Rem}
    If $x ∈ S$ then a covector $(x, ξ)$ is called \emph{degenerate} if it is contained in $D^*_SX = T^*SX ∩ \bigcap_{S' \ne S} \overline{T^*_{S'} X}$.
    The smooth locus of $Λ_{\setset S}$ consists exactly of the non-degenerate covectors\todo{Why?}.\todo{Why the transversality condition?}
\end{Rem}

Recall that for any test triple $(x,ξ,F)$ there is a vanishing cycles functor 
\[
    φ_F\colon D_{\setset S}(B_ε(x)) → \dconstrb{F^{-1}(0) ∩ B_ε(x)}.
\]
Note that for any $\sheaf F ∈ D_{\setset S}(B_ε(x))$ the sheaf $φ_F \sheaf F$ is supported at $x$ \cite[Proposition~4.2.7]{Dimca:2004:SheavesInTopology}\todo{Or (without proof) \cite[(8.6.12)]{KashiwaraSchapira:1994:SheavesOnManifolds}}.
%\begin{Lem}[{\cite[Proposition~4.2.7]{Dimca:2004:SheavesInTopology}}]
%    \label{lem:constructible:supp_of_vc_in_critical_locus}%
%    Let $\sheaf F$ be a constructible sheaf on $X$ with respect to the  Whitney stratification $\setset S$.
%    Then 
%    \[
%        \supp \pervVC{f}\sheaf F \subseteq Σ_{\setset S}(f).
%    \]
%\end{Lem}

\begin{Def}
    Let $(x, ξ, F)$ be a test triple.
    The \emph{local Morse group functor} (or \emph{microlocal stalk functor}) is
    \[
        \localMorse{x}{F}{\sheaf F} = ι_x^* \pervVC{F} j^* {\sheaf F}\colon D^b_{\setset S}(X) → D^b(ℂ),
    \]
    where $j$ is the inclusion $B_ε(x) \hookrightarrow X$.
\end{Def}

Using standard facts about the vanishing cycles functor\todo{reference?}\ it is easy to see that the local Morse group functor is t-exact from the perverse t-structure on $D^b_{\setset S}(X)$ to the standard t-structure on $D^b(ℂ)$.
The following theorem show that moreover it can be used to test whether a given sheaf is perverse.

% ToDo: Proof or reference
%\begin{Thm}[{\cite[Corollary~10.3.13]{KashiwaraSchapira:1994:SheavesOnManifolds}}]
%    Let $f\colon X → ℂ$ be a holomorphic function.
%    Then the functor $\pervVC{f}$ is t-exact with respect to the t-structure given by the middle perversity.
%\end{Thm}

\begin{Thm}[{\cite[Proposition 2.9]{Jin:arXiv:HolomorphicLagrangianBranesCorrespondToPerverseSheaves}}]
    For each stratum $S ∈ \setset S$ choose a test triple $(x_S, ξ_S, F_S)$ with $(x_S , ξ α ) ∈ T^*_S X$.
    Then a sheaf $\sheaf F ∈ D^b_{\setset S}(X)$ is perverse if and only $\localMorse{x_S}{F_S}{\sheaf F}$ has is concentrated in cohomological degree $0$ for all $S ∈ \setset S$.
\end{Thm}
% ToDo: read proof

The following lemma is supposedly standard.
\begin{Lem}
    Let $(x, ξ, F)$ be a test triple and $\sheaf F ∈ D^b_{\setset S}(X)$.
    Then there are (canonical?) isomorphisms
    \[
        \localMorse{x}{F}{\sheaf F} \cong
        Γ\bigl(B_ε(x),\, B_ε(x) ∩ F^{-1}(t),\, \sheaf F\bigr) \cong
        Γ\bigl(B_ε(x),\, B_ε(x) ∩ \{\Re F < μ\},\, \sheaf F\bigr)
    \]
    for $0 < \abs{t} \ll 1$ and $μ \le 0$ with $\abs{μ} \ll 1$.
\end{Lem}
% ToDo: proof/reference

Next: Unstable manifold.

\section{Old stuff}


The introduction of \cite{Koppensteiner:arXiv:ExactFunctorsOnPerverseCoherentSheaves} states the following:

\begin{quote}
    Let $\sheaf F$ be a constructible (middle) perverse sheaf on an affine Kähler manifold $X$.
    Let $x ∈ X$ be point and $f\colon X → ℂ$ a suitably chosen holomorphic Morse function with $f(x) = 0$ and single critical point $x$.
    Then the stalk $(ϕ_{\!f}\sheaf F)_x$ is concentrated in cohomological degree $0$ (here we use $φ_{\!f}$ for the vanishing cycles functor).
    A more \enquote{geometric} formulation of this statement can be obtained in the following way.
    Let $L$ be the stable manifold for the gradient of the Morse function $\Re f$.
    Write $ι_x \colon \{x\} \hookrightarrow L$ and $ι_L\colon L \hookrightarrow X$ for the inclusions.
    Then $ι_x^*ι_L^! \sheaf F$ is also concentrated in cohomological degree $0$.
    Note that $L$ is a Lagrangian with respect to the symplectic structure given by the Kähler form.
\end{quote}

The purpose of this note is to make these claims precise and prove them.

\begin{Rem}
    Here we use the definition of the vanishing cycles functor as given in \cite{KashiwaraSchapira:1994:SheavesOnManifolds}.
    This is off by a shift by $1$ from the definition used in many other places, e.g.~\cite{Massey:arXiv:v6:NotesOnPerverseSheavesAndVanishingCycles}.
\end{Rem}

\subsection{Perverse sheaves, Morse functions and vanishing cycles}

\begin{Q}
    Why is $(φ_f\sheaf F)_x$ concentrated in degree $0$.
\end{Q}


The following is a complexification of \cite[Definition~2.3]{Massey:unpublished:StratifiedMorseTheory} \cite[Definition~2.1]{GoreskyMacPherson:1988:StratifiedMorseTheory}.

\begin{Def}
    Fix a Whitney stratification $\setset S$ of $X$.
    A \emph{stratified holomorphic Morse function} (with respect to $\setset S$ is a proper holomorphic function $f\colon X → ℂ$ with distinct (stratified) critical values and non-degenerate (stratified) critical points.
    (See the referenced definition for the meaning of non-degenerate is this setting.)
\end{Def}

\begin{Rem}
    We should probably compactify $X$ so that this definition applies.
    However since we are only interested in local properties at $x$ this doesn't really change anything.

    Actually properness is kind of a problem in the above definition (all holomorphic maps on a compact complex manifold are constant).
    So we might need to have $f$ meromorphic?
\end{Rem}

\begin{Lem}
    Let $f$ be a stratified holomorphic Morse function.
    Then the set $Σ_{\setset S}(f)$ is discrete.
\end{Lem}

\begin{proof}
    Any non-degenerate stratified critical point is an isolated point of $Σ_{\setset S}(f)$.
\end{proof}

The following claim is a complexified version of \cite[Theorem~2.2.1]{GoreskyMacPherson:1988:StratifiedMorseTheory} \cite[Theorem~2.4]{Massey:unpublished:StratifiedMorseTheory}.

\begin{Claim}
    The stratified Morse function with respect to $\setset S$ are a dense open subset of all proper holomorphic functions on $X$.
\end{Claim}

\begin{Cor}
    Let $\sheaf F$ be a perverse sheaf on $X$ (with respect to the middle perversity).
    Let $\setset S$ be a complex Whitney stratification of $X$ with respect to which $\sheaf F$ is $ℂ$-constructible.
    Fix a point $x ∈ X$.
    Then for every holomorphic Morse function $f$ with respect to $\setset S$ such that $f(x) = 0$ and $df(x) = 0$ the vanishing cycle stalk $φ_f(\sheaf F)_x$ is concentrated in cohomological degree $0$.
\end{Cor}

\begin{proof}
    By the above there exists an open neighborhood $U$ of $x$ in $X$ such that $\res{φ_f(\sheaf F)}{U∩f^{-1}(0)}$ is a perverse skyscraper sheaf at $x$.
    Hence $φ_f(\sheaf F)_x$ is a perverse sheaf on $\{x\}$, i.e.~it is concentrated in degree $0$.
\end{proof}


\subsection{Vanishing cycles and (un)stable manifolds}

\begin{Q}
    Why is $i_x^*i_L^!\sheaf F$ concentrated in degree $0$?
    What about $i_x^!i_L^*\sheaf F$?
    And why is $L$ a Lagrangian?
\end{Q}

The function $\Re f$ has index $d = \dim_ℂ X = \frac12 \dim_ℝ X$ [as $f \sim \sum z_i²$ and hence $\Re f \sim \sum x_i² - y_i²$].
Hence by a basic theorem of Morse theory (?) this implies that the (un)stable manifold for $f$ with respect to $x$ has dimension $d$.

By \cite[Exercise~?]{KashiwaraSchapira:1994:SheavesOnManifolds},
\[
    φ_f(\sheaf F)_x \cong Γ_{\{\Re f \ge 0\}}(\sheaf F)_x.
\]
If $f$ is a holomorphic Morse function, then $f$ is locally of the form $\sum z_i²$ and hence $V = \{ \Re f \ge 0\}$ is a cone.
The unstable manifold $Z$ of $\Re f$ is a closed conical submanifold of this cone.
Thus to compute the !-restriction to $Z$, we can first restrict to $V$ and then to $Z$.
Let $i\colon Z \hookrightarrow V$.
Then one should be able to show that $i_x^*i_Z^! \sheaf G = i_x^*\sheaf G$, where $\sheaf G =  Γ_{\{\Re f \ge 0\}}(\sheaf F)$.
This is evident from the fact that $\sheaf G$ is a skyscraper at $x$.

\subsection{Reverse implications}

\begin{Q}
    Can the above statements be used to characterize perverse sheaves?
\end{Q}

\subsection{Vanishing cycles and microlocal perverse sheaves}

\begin{Q}
    Why should the above characterization be considered to be a microlocal one?.
\end{Q}

\section{Constructible version of Theorem~\ref{thm:main}}\label{sec:constructible_main_thm}

We return now to the claim about exact functors on the t-structure of constructible perverse sheaves made in the introduction.
For simplicity we restrict to the complex (i.e.~middle perversity) case.
Thus let $X$ be a complex manifold and $\setset S$ a finite stratification of $X$ by complex submanifolds.
We write $D^b_{\setset S}(X)$ for the bounded derived category of $\setset S$-constructible sheaves on $X$.
We call a sheaf $\sheaf F ∈ \smash[t]{D^b_{\setset S}(X)}$ perverse if it is perverse with respect to the middle perversity function on $\setset S$.
We are going to formulate and prove an analog of Theorem~\ref{thm:main} in this situation.

A closed real submanifold $Z$ of $X$ is called a \emph{measuring submanifold} if for each stratum $S$ of $X$ either $Z ∩ \overline S = \emptyset$ or $\dim_ℝ Z ∩ S = \dim_ℂ S$.
A \emph{measuring family} is a collection of measuring submanifolds $\{ Y_i \}$ such that each connected component of each stratum has non-empty intersection with at least one $Y_i$.
Similarly to Theorem~\ref{thm:existence_of_lcimeasuring}, one shows inductively that such a collection of submanifolds always exists.

\begin{Thm}
    Let $\measuringFam$ be a measuring family of submanifolds of $X$.
    A sheaf $\sheaf F ∈ D^b_{\setset S}(X)$ is perverse if and only if $ι_Z^! \sheaf F$ is concentrated in cohomological degree $0$ for each submanifold $Z ∈ \measuringFam$.
\end{Thm}

The proof of the following lemma is based on a MathOverflow post by Geordie Williamson \cite{MO:VanishingShriekRestrictionConstructible}.
The author takes responsibility for possible mistakes.

\begin{Lem}\label{lem:constructible_local_vanishing}%
    Let $X$ be a real manifold, $\sheaf F$ be a constructible sheaf (concentrated in degree $0$) on $X$ and let $i\colon Z \hookrightarrow X$ be the inclusion of a closed submanifold.
    Then $H^j(i^!\sheaf F) = 0$ for $j>\codim_XZ$.
\end{Lem}

\begin{proof}
    By taking normal slices we can reduce to the case that $Z = \{z\}$ is a point.
    Let $j$ be the inclusion of $X \setminus \{z\}$ into $X$ and consider the distinguished triangle
    \[
        i_!i^! \sheaf F → \sheaf F → j_*j^*\sheaf F \xrightarrow{+1}.
    \]
    By~\cite[Lemma~8.4.7]{KashiwaraSchapira:1994:SheavesOnManifolds} we have
    \[
        H^j(j_*j^*\sheaf F)_z = H^j(S^{\dim X - 1}_ε, \sheaf F)
    \]
    for a sphere $S^{\dim X - 1}_ε$ around $z$ of sufficiently small radius.
    The latter cohomology vanishes for $j \ge \dim X$ and hence $H^j(i^! \sheaf F) = 0$ for $j>\dim X$ as required.
\end{proof}

\begin{proof}[Proof of Theorem]
    Define two full subcategories $\perv[L] D^{\le 0}(X)$ and $\perv[L] D^{\ge 0}(X)$ of $D^b_{\setset S}(X)$ by
    \begin{align*}
        \perv[L] D^{≤0}(X) & = \left\{ \sheaf F ∈ D^b_{\setset S}(X) : ι_Z^! \sheaf F ∈ D^{≤0}(Z) \text{ for all $Z ∈ \measuringFam$} \right\}, \\
        \perv[L] D^{≥0}(X) & = \left\{ \sheaf F ∈ D^b_{\setset S}(X) : ι_Z^! \sheaf F ∈ D^{≥0}(Z) \text{ for all $Z ∈ \measuringFam$} \right\}.
    \end{align*}
    We will show that these categories are the same as the categories $\perv D^{≤0}(X)$ and $\perv D^{≥0}(X)$ defining the perverse t-structure on $D^b_{\setset S}(X)$.

    We induct on the number of strata.
    If $X$ consists of only one stratum and $Z$ is a measuring submanifold, then $ι_Z^! \sheaf F \cong ω_{Z/X} \otimes ι_Z^* \sheaf F$ and hence $ι_Z^! \sheaf F$ is in degree $0$ if and only if $\sheaf F$ is in degree $-\frac 12 \dim_ℝ X$.
    So assume that $X$ has more then one stratum.
    Without loss of generality we can assume that $X$ is connected.
    Let $U$ be the union of all open strata and $F$ its complement.
    Both $U$ and $F$ are unions of strata of $X$.
    Let $j$ be the inclusion of $U$ and $i$ the inclusion of $X$. 
    
    \begin{itemize}
        \item 
            If $\sheaf F ∈ \perv D^{≤0}(X)$, then $\sheaf F ∈ \perv[L] D^{≤0}$ follows in exactly the same way as in the coherent case, using Lemma~\ref{lem:constructible_local_vanishing}.
        \item 
            Let $\sheaf F ∈ \perv D^{≥0}(X)$.
            Then $i^! \sheaf F ∈ \perv D^{≥0}(F)$ and $j^*\sheaf F ∈ \perv D^{≥0}(U)$.
            Let $Z$ be a measuring subvariety.
            Consider the distinguished triangle 
            \[ 
                i_*i^! \sheaf F → \sheaf F → j_*j^*\sheaf F.
            \]
            Using base change, induction and the (left)-exactness of the push-forward functors one sees that $ι_Z^!$ of the outer sheaves in the triangle are concentrated in non-negative degrees.
            Thus so is $ι_Z^! \sheaf F$.
        \item 
            Let $\sheaf F ∈ \perv[L] D^{≥0}(X)$.
            Since all measurements are local this implies that $j^* \sheaf F ∈ \perv[L] D^{≥0}(U) = \perv D^{≥0}(U)$.
            Using the same triangle and argument as in the last point, this implies that also $i^! \sheaf F ∈ \perv[L] D^{≥0}(F) = \perv D^{≥0}(F)$.
            Hence, by recollement, $\sheaf F ∈ \perv D^{≥0}(X)$.
        \item 
            Finally, let $\sheaf F ∈ \perv[L] D^{≤0}(X)$.
            Again this immediately implies that $j^* \sheaf F ∈ \perv[L] D^{≤0}(U) = \perv D^{≤0}(U)$.
            Thus $j_!j^*\sheaf F ∈ \perv D^{≤0}(X)$.
            Let $Z$ be a measuring submanifold and consider the distinguished triangle
            \[
                ι_Z^! j_!j^*\sheaf F → ι_Z^! \sheaf F → ι_Z^! i_*i^* \sheaf F.
            \]
            By what we already know, the first sheaf is concentrated in non-positive degrees and hence so is $ι_Z^! i_*i^* \sheaf F$.
            By base change and the exactness of $i_*$ this implies that $i^* \sheaf F ∈ \perv[L] D^{≤0}(F) = \perv D^{≤0}(F)$.
            Hence, by recollement, $\sheaf F ∈ \perv D^{≤0}(X)$.
            \qedhere
    \end{itemize}
\end{proof}

\begin{Rem}
    The equality $\perv D^{≥0}(X) = \perv[L]D^{≥0}(X)$ could also be proved in exactly the same way as in the coherent case, using~\cite[Exercise~\textsc{x}.10]{KashiwaraSchapira:1994:SheavesOnManifolds}.
\end{Rem}
