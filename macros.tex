% general
% -------

% Formatting of upper case roman numerals (in references).
\newcommand{\RomanNum}[1]{\textsc{\MakeLowercase{#1}}}

% Normalize Greek letters
\newunicodechar{ϱ}{ρ}
\newunicodechar{ϑ}{θ}
\newunicodechar{ϕ}{φ}

% math
% ----

\let\bar\overline

% TeX Gyre Termes Math does not contain the following symbol
\AtBeginDocument{
    \renewcommand\setminus{-}
}

\AtBeginDocument{%
    \renewcommand\Re{\mathfrak{Re}}%    % real part
    \renewcommand\Im{\mathfrak{Im}}%    % imaginary part
}

% restriction
\newcommand\res[2]{\mathchoice{\left.#1\right|_{#2}}{#1|_{#2}}{#1|_{#2}}{#1|_{#2}}}

% quotients
\newcommand\rquot[2]{%
    \mathchoice%
        {\left.#1\kern-0.2ex\middle/\kern-0.3ex\lower0.7ex\hbox{$\displaystyle #2$}\right.}%
        {\left.#1\middle/#2\right.}%
        {\left.#1\middle/#2\right.}%
        {\left.#1\middle/#2\right.}%
}

\newcommand\cocolon{%                   % colon on the right side (i.e. for an adjunction)
    \nobreak \mskip 6muplus1mu \mathpunct {}\nonscript \mkern -\thinmuskip{:}\mskip 2mu\relax%
}

\newcommand\Forget{\operatorname{Forget}}

\newcommand\isoto{\xrightarrow{\sim}}

\newcommand\proj[1]{\operatorname{pr}_{#1}} % projection on a factor

% spaces and groups
\newcommand\pt{\mathrm{pt}}
\newcommand\as[2][]{\mathbb A^{#2}_{#1}}        % affine space
\newcommand\ps[2][]{\mathbb P^{#2}_{#1}}        % projective space
\newcommand\Gm{\mathbb{G}_m}                    % G_m
\newcommand\Ga{\mathbb{G}_a}                    % G_a
\newcommand\SL[2]{\ensuremath{\mathrm{SL}_{#1}(#2)}}
\newcommand\LocSys{\operatorname{LocSys}}
\newcommand\Bun{\operatorname{Bun}}

\newcommand\setset\mathfrak             % a set of subsets

\newcommand\codim{\operatorname{codim}}

\newcommand\ideal\mathfrak
\DeclareMathOperator\Spec{Spec}
\DeclareMathOperator\supp{supp}

% categories
\newcommand\cat{\mathbf}
\DeclareMathOperator\Hom{Hom}
\newcommand\id[1][]{{\mathrm{Id}_{#1}}}
\newcommand\catVect[1][]{\cat{Vect}_{#1}}
\newcommand\catModules[1]{#1\text{-}\cat{Mod}}

\newcommand\cx\bullet
\newcommand\dual{∨}

% sheaves
\newcommand\sheaf\mathscr
\newcommand\sheafHom{\sheaf{H\mkern-0.4mu o\mkern-2.5mu m}}
\renewcommand\O{\sheaf O}
\newcommand\catCoh[2][]{\cat{Coh}^{#1}(#2)}
\newcommand\catIndCoh[2][]{\cat{IndCoh}_{#1}(#2)}
\newcommand\catDMod[2][]{\cat{DMod}_{#1}(#2)}

% perverse-coherents
% ------------------

\newcommand\dualize{\mathbb D}
\newcommand\dualizingCx{\sheaf{D\mkern-0.3mu C}}
\newcommand\lc[1]{\Gamma_{\mkern-3mu#1}}
\newcommand\measuringFam{\mathfrak M}
\newcommand\Xtop[1][X]{#1^{G,\mathrm{gen}}}

\newcommand\dcat[3][]{\mathbf{D}_{#1}^{#2}(#3)}
\newcommand\dcoh[2][]{\dcat[\mathrm{coh}]{#1}{#2}}
\newcommand\dqc[2][]{\dcat[\mathrm{qc}]{#1}{#2}}
\newcommand\dcohb[1]{\dcoh[b]{#1}}
\newcommand\dcohbG[2][G]{\dcohb{#2}^{#1}}
\newcommand\dcohbGheart[2][G]{\dcohb{#2}^{#1,\heartsuit}}
\newcommand\dqcb[1]{\dqc[b]{#1}}
\newcommand\dqcbG[2][G]{\dqcb{#2}^{#1}}
\newcommand\dconstrb[2][\mathrm{constr}]{\dcat[#1]{b}{#2}}

\newcommand\perv[1][p]{\mkern1mu{}^{#1}\mkern-1mu}
\newcommand\dpc[3][p]{\perv[#1]\dcat{#2}{#3}^G}
\newcommand\dpconstr[3]{\perv[p]\dcat[#1]{#2}{#3}}
\newcommand\PervConstr[2][]{\mathup{Perv}_{#1}(#2)}

\newcommand\lciname{strong}

\newcommand\pervVC[1]{φ_{#1}[-1]}
\newcommand\localMorse[3]{M_{#1,#2}(#3)}

% d-modules
% ----------

\let\stack\mathbf

\newcommand\catDModHol[1]{\catDMod[\mathup{hol}]{#1}}
\newcommand\catDModMon[2]{\catDMod{#1}^{#2-\mathup{mon}}}
\newcommand\catDModHolMon[2]{\catDModHol{#1}^{#2-\mathup{mon}}}

\newcommand\dR{\mathrm{dR}}
\newcommand{\renstar}{\blacktriangle}

\newcommand{\HCoh}{\operatorname{HH}^\cx}
\newcommand\ΓdR{Γ_{\mkern-4mu\dR}}

\newcommand\opalg[1]{#1^{\mathrm{op}}}

\renewcommand\B{\stack{B}}
\newcommand\mappingstack{\mathbfup{Maps}}
\newcommand\X{\mathbb{X}}

\let\Γsub\lc

\newcommand\ls[1]{\mathbfcal{L} #1}
\newcommand\lsY[1]{\mathbfcal{L}_{\stack Y} #1}
\newcommand\cls[1]{\overline{\mathbfcal{L}} #1}
\newcommand\clsY[1]{\overline{\mathbfcal{L}}_{\stack Y} #1}
\newcommand\lsc[1]{\mathbfcal{L}^c #1}
\newcommand\lscY[1]{\mathbfcal{L}_{\stack Y}^c #1}

\newfontfamily\cyrillicfont[Script=Cyrillic]{XITS}
\newcommand\cyrmath[1]{\textit{\cyrillicfont #1}}

%\newcommand\schemels[1]{\mathcal{L}\mkern2.5mu #1}
%\newcommand\schemecls[1]{\overline{\mathcal{L}}\mkern2.5mu #1}
%\newcommand\schemelsc[1]{\mathcal{L}\mkern2.5mu^c #1}
\newcommand\schemels[2][]{\cyrmath{Л}\mkern1.5mu^{#1}#2}
\newcommand\schemelsY[2][]{\schemels[#1]{_{\stack Y}#2}}
\newcommand\schemecls[2][]{\overline{\cyrmath{Л}}\mkern1.5mu^{#1}#2}
\newcommand\schemeclsY[2][]{\schemecls[#1]{_{\stack Y}#2}}
\newcommand\schemelsc[2][]{\cyrmath{Л}\mkern1.5mu^{\if\relax\detokenize{#1}\relax\else#1,\fi c} #2}
\newcommand\schemelscY[2][]{\schemelsc[#1]{_{\stack Y}#2}}

\newcommand\schemei{\cyrmath{и}}
\newcommand\schemej{\cyrmath{й}}
\newcommand\schemeq{\cyrmath{к}}
\newcommand\schemeh{h'}
%\newcommand\schemep{\cyrmath{п}}
%\newcommand\schemei{\tilde{\imath}}
%\newcommand\schemej{\tilde{\jmath}}
%\newcommand\schemeq{\tilde{q}}
%\newcommand\schemeh{\tilde{h}}

\newcommand\Stab{\operatorname{Stab}}

\newcommand\goodstack{good}
\newcommand\Goodstack{Good}
\newcommand\goodness{goodness}
